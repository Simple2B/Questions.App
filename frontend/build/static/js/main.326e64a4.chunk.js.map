{"version":3,"sources":["socket.ts","components/asker/Asker.tsx","components/answerer/Answerer.tsx","App.tsx","hooks/useExitPrompt.ts","index.tsx"],"names":["questions_ws","io","Asker","questions","useState","question","setQuestion","question_components","filter","q","session_id","id","map","className","question_text","Date","created_at","toLocaleTimeString","type","placeholder","aria-label","aria-describedby","value","onChange","e","target","onClick","resp","session","emit","Answerer","App","socket","page","setPage","activeQuestions","setActiveQuestions","useEffect","on","send","status","data","console","log","handler","handlerRef","useRef","current","handleBeforeunload","evt","returnValue","defaultPrevented","window","addEventListener","removeEventListener","useBeforeunload","event","client_data","message","preventDefault","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.326e64a4.chunk.js","sourcesContent":["import { io } from \"socket.io-client\";\r\n\r\nexport const questions_ws = io(\"/questions\");\r\n","import { Socket } from \"socket.io-client\";\r\nimport React, { useState } from \"react\";\r\nimport { questions_ws } from \"../../socket\";\r\nimport \"./asker.css\";\r\nimport { IQuestion } from \"../../types/questionTypes\";\r\n\r\ninterface IAnswererProps {\r\n  questions: IQuestion[];\r\n}\r\n\r\nexport const Asker = ({ questions }: IAnswererProps) => {\r\n  const [question, setQuestion] = useState(\"\");\r\n\r\n  const handleCreateQuestion = () => {\r\n    const resp = {\r\n      session: questions_ws.id,\r\n      question: question,\r\n    };\r\n    if (question) questions_ws.emit(\"create_question\", resp);\r\n  };\r\n  const question_components = questions\r\n    .filter((q) => q.session_id === questions_ws.id)\r\n    .map((question) => (\r\n      <div className=\"answer__container\" key={question.id}>\r\n        <span>{question.question_text}</span>\r\n        <div className=\"button_block\">\r\n          <button className=\"answer__button\">Submit answer</button>\r\n          <div>\r\n            <span>{new Date(question.created_at).toLocaleTimeString()}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    ));\r\n\r\n  return (\r\n    // <div className=\"answer position-absolute top-50 start-50 translate-middle shadow-sm p-3 mb-5 bg-body rounded\">\r\n    <div className=\"asker\">\r\n      <form className=\"asker__form\">\r\n        <div className=\"input-group mb-3\">\r\n          <input\r\n            type=\"text\"\r\n            className=\"form-control\"\r\n            placeholder=\"Ask your question\"\r\n            aria-label=\"Ask your question\"\r\n            aria-describedby=\"button-addon2\"\r\n            value={question}\r\n            onChange={(e) => {\r\n              setQuestion(e.target.value);\r\n            }}\r\n          />\r\n          <button\r\n            className=\"btn btn-success\"\r\n            type=\"button\"\r\n            id=\"button-addon2\"\r\n            onClick={handleCreateQuestion}\r\n          >\r\n            Ask\r\n          </button>\r\n        </div>\r\n      </form>\r\n      <div className=\"answer\">{question_components}</div>\r\n      {/* <span>Total number of replies: {questions.length}</span> */}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { IQuestion } from \"../../types/questionTypes\";\r\nimport \"./answerer.css\";\r\n\r\ninterface IAnswererProps {\r\n  questions: Array<IQuestion>;\r\n}\r\n\r\nexport const Answerer = ({ questions }: IAnswererProps) => {\r\n  const question_components = questions.map((question) => (\r\n    <div className=\"answer__container\" key={question.id}>\r\n      <span>{question.question_text}</span>\r\n      <div className=\"button_block\">\r\n        <button className=\"answer__button\">Submit answer</button>\r\n        <div>\r\n          <span>{new Date(question.created_at).toLocaleTimeString()}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  ));\r\n  return (\r\n    // <div className=\"answer translate-middle shadow-sm p-3 mb-5 bg-body rounded\">\r\n    <div className=\"answer\">\r\n      <p>Answerer window</p>\r\n      {question_components}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { questions_ws } from \"./socket\";\r\nimport { Socket } from \"socket.io-client\";\r\nimport { useBeforeunload } from \"./hooks/useExitPrompt\";\r\nimport { Asker } from \"./components/asker/Asker\";\r\nimport { Answerer } from \"./components/answerer/Answerer\";\r\nimport \"./app.css\";\r\n\r\nconst questionsFromServer = [\r\n  { id: 1, header: \"Header 1\", question: \"rem ipsum dolor sit amet\", time: 15 },\r\n  { id: 2, header: \"Header 2\", question: \"rem ipsum dolor sit amet\", time: 15 },\r\n  { id: 3, header: \"Header 3\", question: \"rem ipsum dolor sit amet\", time: 15 },\r\n  { id: 4, header: \"Header 4\", question: \"rem ipsum dolor sit amet\", time: 15 },\r\n];\r\n\r\nexport const App = () => {\r\n  const [socket, setSocket] = useState<Socket>(questions_ws);\r\n  const [page, setPage] = useState(true);\r\n  const [activeQuestions, setActiveQuestions] = useState([]);\r\n\r\n  const handleGetQuestions = () => {\r\n    socket.emit(\"get_active_questions\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    socket.on(\"connect\", () => {\r\n      socket.send(`User ${socket.id} has connected`);\r\n    });\r\n\r\n    socket.on(\"success_active_questions\", (resp) => {\r\n      if (resp.status === \"success\") {\r\n        setActiveQuestions(resp.data);\r\n      }\r\n    });\r\n\r\n    socket.on(\"question_create_success\", (resp) => {\r\n      socket.emit(\"get_active_questions\");\r\n      console.log(resp);\r\n    });\r\n\r\n    handleGetQuestions();\r\n  }, []);\r\n\r\n  useBeforeunload((event) => {\r\n    console.log(socket);\r\n\r\n    const client_data = {\r\n      session: socket.id,\r\n      message: \"disconnected successfully\",\r\n    };\r\n    console.log(client_data);\r\n\r\n    socket.emit(\"leave_service\", client_data);\r\n    // socket.disconnect();\r\n    event.preventDefault();\r\n  });\r\n\r\n  const handlePage = () => {\r\n    setPage(!page);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <button onClick={handlePage}>Change Page</button>\r\n      <div>\r\n        {page ? (\r\n          <Asker questions={activeQuestions} />\r\n        ) : (\r\n          <Answerer questions={activeQuestions} />\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n","// import { useState, useEffect } from \"react\";\r\n\r\n// const initBeforeUnLoad = (showExitPrompt:boolean) => {\r\n//   window.onbeforeunload = (event:Event) => {\r\n//     if (showExitPrompt) {\r\n//       const e = event || window.event;\r\n//       e.preventDefault();\r\n//       if (e) {\r\n//         e.returnValue = \"\";\r\n//       }\r\n//       return \"\";\r\n//     }\r\n//   };\r\n// };\r\n\r\n// // Hook\r\n// export default function useExitPrompt(bool:boolean) {\r\n//   const [showExitPrompt, setShowExitPrompt] = useState(bool);\r\n\r\n//   window.onload = function () {\r\n//     initBeforeUnLoad(showExitPrompt);\r\n//   };\r\n\r\n//   useEffect(() => {\r\n//     initBeforeUnLoad(showExitPrompt);\r\n//   }, [showExitPrompt]);\r\n\r\n//   return [showExitPrompt, setShowExitPrompt];\r\n// }\r\n\r\nimport { useEffect, useRef } from \"react\";\r\n\r\ntype BeforeunloadHandler = (evt: BeforeUnloadEvent) => void;\r\n\r\nexport function useBeforeunload(handler: BeforeunloadHandler) {\r\n  const handlerRef = useRef(handler);\r\n\r\n  useEffect(() => {\r\n    handlerRef.current = handler;\r\n  }, [handler]);\r\n\r\n  useEffect(() => {\r\n    const handleBeforeunload: BeforeunloadHandler = (evt) => {\r\n      let returnValue;\r\n\r\n      if (typeof handlerRef.current === \"function\") {\r\n        returnValue = handlerRef.current(evt);\r\n      }\r\n\r\n      if (evt.defaultPrevented) {\r\n        evt.returnValue = \"\";\r\n      }\r\n\r\n      if (typeof returnValue === \"string\") {\r\n        evt.returnValue = returnValue;\r\n        return returnValue;\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"beforeunload\", handleBeforeunload);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"beforeunload\", handleBeforeunload);\r\n    };\r\n  }, []);\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport { App } from \"./App\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}